    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.4/socket.io.js" integrity="sha512-aMGMvNYu8Ue4G+fHa359jcPb1u+ytAF+P2SCb+PxrjCdO3n3ZTxJ30zuH39rimUggmTwmh2u7wvQsDTHESnmfQ==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> 
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/d3-cloud@1.2.5/build/d3.layout.cloud.js"></script>
        <title>Real-time Sentiment Analysis</title>
    </head>
    <body>
        <div class="card_tweets">
            <section class="tweets">
                <h2>Tweets</h2>
                <div class="tweetMsg">
                        <div id="log"></div><br>
                </div>

            </section>
        </div> 
        <div class="charts">
            <div class="Topic1pieChart"><canvas id="Topic1pieChart" class="Topic1pieChart"></canvas></div>
            <div class="Topic2pieChart"><canvas id="Topic2pieChart" class="Topic2pieChart"></canvas></div>
            <div class="Topic1BarChart"><canvas id="Topic1BarChart"></canvas></div>
            <div class="Topic2BarChart"><canvas id="Topic2BarChart"></canvas></div>
            <div class="radarChart"><canvas id="radarChart"></canvas></div>
            <div class="scatterChart"><canvas id="scatterChart"></canvas></div>
            <div class="lineChart"><canvas id="lineChart"></canvas></div>
            <div class="polarAreaChart"><canvas id="polarAreaChart"></canvas></div>
            <h2>Suyash's chart 1</h2>
            <div class="Topic1HashTagBarChart"><canvas id="Topic1HashTagBarChart"></canvas></div>
            <div class="Topic2HashTagBarChart"><canvas id="Topic2HashTagBarChart"></canvas></div>
            <h2>Suyash's chart 2</h2>
            <div id="chart2"></div>
            <h2>Suyash's chart 3</h2>
            <div id="wordcloud"></div>
        </div>

        <script type="text/javascript" charset="utf-8">
            const Topic1Barctx = document.getElementById('Topic1BarChart');
            const Topic2Barctx = document.getElementById('Topic2BarChart');
            const topic1piectx = document.getElementById('Topic1pieChart');
            const topic2piectx = document.getElementById('Topic2pieChart');
            const radarcxt = document.getElementById('radarChart');
            const linectx=document.getElementById('lineChart');
            const polarAreactx=document.getElementById('polarAreaChart');
            const topic1hashctx = document.getElementById('Topic1HashTagBarChart');
            const topic2hashctx = document.getElementById('Topic2HashTagBarChart');

            var result = {{ result | safe}};  
            let Topic1positiveTweets = result.topic1.aggregate.positiveTweets;
            let Topic1NegativeTweets = result.topic1.aggregate.negativeTweets;
            let Topic1NeutralTweets = result.topic1.aggregate.neutralTweets;
            let Topic1totalTweets = Topic1positiveTweets + Topic1NegativeTweets + Topic1NeutralTweets;

            let Topic2positiveTweets = result.topic2.aggregate.positiveTweets;
            let Topic2NegativeTweets = result.topic2.aggregate.negativeTweets;
            let Topic2NeutralTweets = result.topic2.aggregate.neutralTweets;
            let Topic2totalTweets = Topic2positiveTweets + Topic2NegativeTweets + Topic2NeutralTweets;
            console.log(Topic2totalTweets)
              
        
            const topic1barChart = new Chart(Topic1Barctx, {
            type: 'bar',
            data: {
            labels: ["Positive", "Negative", "Neutral"],
            datasets: [{
                label: '# of Positive and negative sentiments',
                data: [0,0,0],
                backgroundColor: [
                    'rgba(91, 240, 65, 0.6)',
                    'rgba(245, 7, 7, 0.6)',
                    'rgba(245, 193, 7, 0.6)'
                ],
                borderColor: [
                    'rgb(53, 245, 20)',
                    'rgb(245, 7, 7)',
                    'rgb(245, 193, 7)'
                ],
                borderWidth: 1,
                borderRadius: 10
            }]
            },
            options: {
            scales: {
                y: {
                beginAtZero: true
                }
            },
            plugins: {
                    title: {
                        display: true,
                        text: 'Topic 1 Bar chart'
                    }
                }
            }
        });

        const topic2barChart = new Chart(Topic2Barctx, {
            type: 'bar',
            data: {
            labels: ["Positive", "Negative", "Neutral"],
            datasets: [{
                label: '# of Positive and negative sentiments',
                data: [0,0,0],
                backgroundColor: [
                    'rgba(91, 240, 65, 0.6)',
                    'rgba(245, 7, 7, 0.6)',
                    'rgba(245, 193, 7, 0.6)'
                ],
                borderColor: [
                    'rgb(53, 245, 20)',
                    'rgb(245, 7, 7)',
                    'rgb(245, 193, 7)'
                ],
                borderWidth: 1,
                borderRadius: 10
            }]
            },
            options: {
            scales: {
                y: {
                beginAtZero: true
                }
            },
            plugins: {
                    title: {
                        display: true,
                        text: 'Topic 2 Bar chart'
                    }
                }
            }
        });

        const topic1pieChart = new Chart(topic1piectx, {
            type: 'doughnut',
            options: {
                plugins: {
                    title: {
                        display: true,
                        text: 'Topic 1 Pie chart'
                    }
                }
            },
            data: {
              labels: ["Positive", "Negative", "Neutral"],
              datasets: [{
                  label: '% of Positive and Negative sentiments',
                  data: [0,0,0],
                  backgroundColor: [
                      'rgba(91, 240, 65, 0.6)',
                      'rgba(245, 7, 7, 0.6)',
                      'rgba(245, 193, 7, 0.6)'
                  ],
                  hoverOffset: 4
              }]
            }
        });

        const topic2pieChart = new Chart(topic2piectx, {
            type: 'doughnut',
            options: {
                plugins: {
                    title: {
                        display: true,
                        text: 'Topic 2 Pie chart'
                    }
                }
            },
            data: {
              labels: ["Positive", "Negative", "Neutral"],
              datasets: [{
                  label: '% of Positive and Negative sentiments',
                  data: [0,0,0],
                  backgroundColor: [
                      'rgba(91, 240, 65, 0.6)',
                      'rgba(245, 7, 7, 0.6)',
                      'rgba(245, 193, 7, 0.6)'
                  ],
                  hoverOffset: 4
              }]
            }
        });
            
            // Set up the radarChart options
            const radarChart = new Chart(radarcxt, {
            type: 'radar',
            data: {
                labels: ['Positive', 'Negative', 'Neutral'],
                datasets: [{
                    label: 'Sentiment Analysis Metrics',
                    data: [0, 0, 0],
                    backgroundColor: 'rgba(91, 240, 65, 0.2)',
                    borderColor: 'rgb(53, 245, 20)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    r: {
                        min: 0,
                        max: 1
                    }
                }
            }
        });

    //---------------------------------Kajal Code------------------------------

        const lineChart = new Chart(linectx, {
            type: 'line',
            data: {
                labels: ['Positive', 'Negative', 'Neutral', 'Intensity', 'Subjectivity'], // Array of labels for the x-axis
                datasets: [{
                label: 'Line Chart',
                data: [], // Array of data points for the y-axis
                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                borderColor: 'rgba(255, 99, 132, 1)',
                borderWidth: 1
                }]
            },
            options: {
                scales: {
                x: {
                    type: 'linear',
                    position: 'bottom'
                },
                y: {
                    type: 'linear',
                    position: 'left'
                }
                }
            }
            });

            const polarAreaChart = new Chart(polarAreactx, {
            type: 'polarArea',
            data: {
                labels: ['Positive', 'Negative', 'Neutral', 'Intensity', 'Subjectivity'],
                datasets: [{
                label: 'Polar Area Chart',
                data: [10, 20, 30, 40, 50],
                backgroundColor: ['rgba(255, 99, 132, 0.2)', 'rgba(54, 162, 235, 0.2)', 'rgba(255, 206, 86, 0.2)', 'rgba(75, 192, 192, 0.2)', 'rgba(153, 102, 255, 0.2)'],
                borderColor: ['rgba(255, 99, 132, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)', 'rgba(75, 192, 192, 1)', 'rgba(153, 102, 255, 1)'],
                borderWidth: 1
                }]
            },
            options: {
                scales: {
                r: {
                    suggestedMin: 0,
                    suggestedMax: 100
                }
                }
            }
            });




// --------------------------suyash code----------------------- 
          const Topic1hashTagBar = new Chart(topic1hashctx, {
            type: 'bar',
            data: {
            labels: ["hash","hash","hash"],
            datasets: [{
                label: 'Hashtags',
                data: [0,0,0],
                backgroundColor: [
                  'rgba(255, 99, 132, 0.2)',
                  'rgba(255, 159, 64, 0.2)',
                  'rgba(255, 205, 86, 0.2)',
                  'rgba(75, 192, 192, 0.2)',
                  'rgba(54, 162, 235, 0.2)',
                  'rgba(153, 102, 255, 0.2)',
                  'rgba(201, 203, 207, 0.2)'
                ],
                borderColor: [
                  'rgb(255, 99, 132)',
                  'rgb(255, 159, 64)',
                  'rgb(255, 205, 86)',
                  'rgb(75, 192, 192)',
                  'rgb(54, 162, 235)',
                  'rgb(153, 102, 255)',
                  'rgb(201, 203, 207)'
                ],
            borderWidth: 1,
            borderRadius: 10
            }]
            },
            options: {
            scales: {
                y: {
                beginAtZero: true
                }
            },
            plugins: {
                    title: {
                        display: true,
                        text: 'Topic 1 Top Hashtags'
                    }
                }
            }
        });

        const Topic2hashTagBar = new Chart(topic2hashctx, {
            type: 'bar',
            data: {
            labels: ["hash","hash","hash"],
            datasets: [{
                label: 'Hashtags',
                data: [0,0,0],
                backgroundColor: [
                  'rgba(255, 99, 132, 0.2)',
                  'rgba(255, 159, 64, 0.2)',
                  'rgba(255, 205, 86, 0.2)',
                  'rgba(75, 192, 192, 0.2)',
                  'rgba(54, 162, 235, 0.2)',
                  'rgba(153, 102, 255, 0.2)',
                  'rgba(201, 203, 207, 0.2)'
                ],
                borderColor: [
                  'rgb(255, 99, 132)',
                  'rgb(255, 159, 64)',
                  'rgb(255, 205, 86)',
                  'rgb(75, 192, 192)',
                  'rgb(54, 162, 235)',
                  'rgb(153, 102, 255)',
                  'rgb(201, 203, 207)'
                ],
            borderWidth: 1,
            borderRadius: 10
            }]
            },
            options: {
            scales: {
                y: {
                beginAtZero: true
                }
            },
            plugins: {
                    title: {
                        display: true,
                        text: 'Topic 2 Top Hashtags'
                    }
                }
            }
        });

// -------------------------------------------chart 2----------------------------
const positiveTweets1 = [
  "I love my new phone! #newphone #happy",
  "Had a great time at the beach today! #beach #fun #sunshine",
  "Just got a promotion at work! #excited #career #success"
];
const negativeTweets1 = [
  "Stuck in traffic again! #traffic #frustrated",
  "My phone just died and I lost all my data! #angry #phoneproblems",
  "My boss yelled at me today for no reason. #unfair #upset #workproblems"
];

// Function to extract words from tweets
function extractWords(tweet) {
  const regex = /[a-zA-Z]+/gm;
  const words = [];
  let match;
  while ((match = regex.exec(tweet)) !== null) {
    words.push(match[0].toLowerCase());
  }
  return words;
}

// Extract words from positive and negative tweets
const positiveWords = positiveTweets1.flatMap(extractWords);
const negativeWords = negativeTweets1.flatMap(extractWords);

// Function to count word occurrences
function countWords(words) {
  const counts = {};
  const stopWords = ["i", "my", "me", "we", "us", "you", "he", "she", "it", "they", "them"]; // custom stop words list
  words.filter(word => !stopWords.includes(word)).forEach(word => {
    counts[word] = counts[word] ? counts[word] + 1 : 1;
  });
  return counts;
}

// Count word occurrences for positive and negative tweets
const positiveCounts = countWords(positiveWords);
const negativeCounts = countWords(negativeWords);

// Function to sort word counts by frequency
function sortWords(counts) {
  return Object.entries(counts).sort((a, b) => b[1] - a[1]);
}

// Sort positive and negative word counts by frequency
const sortedPositiveCounts = sortWords(positiveCounts);
const sortedNegativeCounts = sortWords(negativeCounts);

// Function to display top N words
function displayTopWords(counts, n) {
  const topWords = counts.slice(0, n);
  const data = [{
    x: topWords.map(word => word[0]),
    y: topWords.map(word => word[1]),
    type: 'bar'
  }];
  Plotly.newPlot('chart2', data);
}

// Display top 5 positive and negative words
displayTopWords(sortedPositiveCounts, 5);
displayTopWords(sortedNegativeCounts, 5);
// --------------------------------------------Chart 3--------------------------------------------------------
var topic1hashtags = result.topic1.aggregate.hashtags;

var fontSize = d3.scalePow().exponent(5).domain([0,1]).range([10,80]);

d3.layout.cloud().size([500, 500])
  .words(Object.keys(topic1hashtags).map(function(d) {
    return {text: d, size: fontSize(topic1hashtags[d])};
  }))
  .padding(5)
  .rotate(function() { return ~~(Math.random() * 2) * 90; })
  .font("Impact")
  .fontSize(function(d) { return d.size; })
  .on("end", draw)
  .start();

function draw(words) {
  d3.select("#wordcloud").append("svg")
    .attr("width", 500)
    .attr("height", 500)
    .append("g")
    .attr("transform", "translate(250,250)")
    .selectAll("text")
    .data(words)
    .enter().append("text")
    .style("font-size", function(d) { return d.size + "px"; })
    .style("font-family", "Impact")
    .style("fill", function(d, i) { return d3.schemeCategory10[i % 10]; })
    .attr("text-anchor", "middle")
    .attr("transform", function(d) {
      return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
    })
    .text(function(d) { return d.text; });
}

var topic2hashtags = result.topic2.aggregate.hashtags;

var fontSize = d3.scalePow().exponent(5).domain([0,1]).range([10,80]);

d3.layout.cloud().size([500, 500])
  .words(Object.keys(topic2hashtags).map(function(d) {
    return {text: d, size: fontSize(topic2hashtags[d])};
  }))
  .padding(5)
  .rotate(function() { return ~~(Math.random() * 2) * 90; })
  .font("Impact")
  .fontSize(function(d) { return d.size; })
  .on("end", draw)
  .start();

function draw(words) {
  d3.select("#wordcloud").append("svg")
    .attr("width", 500)
    .attr("height", 500)
    .append("g")
    .attr("transform", "translate(250,250)")
    .selectAll("text")
    .data(words)
    .enter().append("text")
    .style("font-size", function(d) { return d.size + "px"; })
    .style("font-family", "Impact")
    .style("fill", function(d, i) { return d3.schemeCategory10[i % 10]; })
    .attr("text-anchor", "middle")
    .attr("transform", function(d) {
      return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
    })
    .text(function(d) { return d.text; });
}

// -----------------------------------------suyash-------------------------------------------------------

        $(document).ready(function() {

            //Test Data
            const xValue = Math.random() * 100;
            const yValue = Math.random() * 100;
            let barhashtags;
            let topic1hashs = [];
            let topic1values = [];
            let topic2hashs = [];
            let topic2values = [];

            for(var key in topic1hashtags){
              topic1hashs.push(key)
              topic1values.push(topic1hashtags[key])  
            }

            for(var key in topic2hashtags){
              topic2hashs.push(key)
              topic2values.push(topic2hashtags[key])  
            }

            topic1barChart.data.datasets[0].data = [Topic1positiveTweets, Topic1NegativeTweets, Topic1NeutralTweets]
            topic2barChart.data.datasets[0].data = [Topic2positiveTweets, Topic2NegativeTweets, Topic2NeutralTweets]
            topic1pieChart.data.datasets[0].data = [(Topic1positiveTweets / Topic1totalTweets) * 100 , (Topic1NegativeTweets / Topic1totalTweets) * 100, (Topic1NeutralTweets / Topic1totalTweets) * 100]
            topic2pieChart.data.datasets[0].data = [(Topic2positiveTweets / Topic2totalTweets) * 100 , (Topic2NegativeTweets / Topic2totalTweets) * 100, (Topic2NeutralTweets / Topic2totalTweets) * 100]
            radarChart.data.datasets[0].data = [Topic1positiveTweets, Topic1NegativeTweets, Topic1NeutralTweets];
            lineChart.data.datasets[0].data = [Topic1positiveTweets, Topic1NegativeTweets, 70, 65, 85];
            polarAreaChart.data.datasets[0].data = [Topic1positiveTweets, Topic1NegativeTweets, 70, 65, 85];
            
            Topic1hashTagBar.data.datasets[0].data = topic1values.slice(0,8);
            Topic1hashTagBar.data.labels = topic1hashs.slice(0,8);
            Topic2hashTagBar.data.datasets[0].data = topic2values.slice(0,8);
            Topic2hashTagBar.data.labels = topic2hashs.slice(0,8);

            radarChart.update();
            topic1barChart.update()
            topic2barChart.update()
            topic1pieChart.update()
            topic2pieChart.update()
            lineChart.update()
            polarAreaChart.update();
            Topic1hashTagBar.update()
            Topic2hashTagBar.update()
          
        });

    </script>
    </body>
    </html>